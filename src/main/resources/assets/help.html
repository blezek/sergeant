<h1 id="sergeant">Sergeant</h1>
<p>Sergeant is a simple <a href="http://dropwizard.github.io/dropwizard/">DropWizard</a> based web application to allow command line programs to be run as web services.  Yes, I know this is dangerous, but so is driving a car.  If one is careful both can be done safely.</p>
<h2 id="installation">Installation</h2>
<h4 id="linux-mac-osx-">Linux / Mac OSX:</h4>
<pre class="editor-colors"><code style="font-family: 'source code pro';">git clone https://github.com/dblezek/sergeant.git
cd sergeant
./gradlew run
</code></pre><h4 id="windows">Windows</h4>
<pre class="editor-colors"><code style="font-family: 'source code pro';">git clone https://github.com/dblezek/sergeant.git
cd sergeant
gradlew.bat run
</code></pre><p>Open <a href="http://localhost:8080/">http://localhost:8080/</a></p>
<h2 id="usage">Usage</h2>
<pre class="editor-colors"><code class="lang-bash" style="font-family: 'source code pro';"><div><span class="source shell">java -jar sergeant.jar server sergeant.yml</span></div></code></pre>
<h2 id="defining-services">Defining services</h2>
<p><strong>Services</strong> are command line interfaces (CLI) exposed through sergeant as REST endpoints.  Services are defined using <a href="http://www.yaml.org/spec/1.2/spec.html">YAML</a> (YAML Ain't Markup Language) in the <strong>sergeant.yml</strong> file, and have several parameters.</p>
<ul>
<li><strong>endPoint</strong>: this is the REST end point that exposes this CLI</li>
<li><strong>description</strong>: a description of the endPoint.  <a href="http://stackoverflow.com/questions/3790454/in-yaml-how-do-i-break-a-string-over-multiple-lines">Descriptions can span multiple lines.</a></li>
<li><strong>commandLine</strong>: an array of parameters that form the command line.  Any parameter of the form "@variable" will be replaced when sergeant runs the CLI.  See the <strong>sleep</strong> example below.</li>
<li><strong>synchronous</strong>: return results immediately</li>
<li><strong>gridSubmit</strong>: Submit to a grid using <a href="http://www.drmaa.org/">DRMAA</a>, must start up with a drmaa library available in <code style="font-family: 'source code pro';">java.library.path</code>.  Ignores the <code style="font-family: 'source code pro';">synchronous</code> setting.</li>
<li><strong>gridSpecification</strong>: String to pass through DRMAA into the underlying grid implementation.</li>
<li><strong>defaults</strong>: a map of default values for any variables in the command line.  This parameter is optional, and variables do not need defaults.</li>
</ul>
<h3 id="synchronous-services">Synchronous services</h3>
<p>Synchronous services return the output immediately.</p>
<pre class="editor-colors"><code class="lang-bash" style="font-family: 'source code pro';"><div><span class="source shell">curl -POST -d <span class="string quoted double shell"><span class="punctuation definition string begin shell">"</span>text=Something going on here<span class="punctuation definition string end shell">"</span></span> http://localhost:8080/rest/service/echo</span></div><div><span class="source shell">Something going on here</span></div></code></pre>
<h3 id="asynchronous-services">Asynchronous services</h3>
<p>By default, services return a uuid that can be used to retrieve results after processing has finished.</p>
<h3 id="service-environment">Service Environment</h3>
<p>Sergeant includes a <code style="font-family: 'source code pro';">sergeantw</code> a wrapper for sergeant services.  <code style="font-family: 'source code pro';">sergeantw</code> looks for a <code style="font-family: 'source code pro';">sergeant-env.sh</code> and sources it to configure a particular environment to run the CLI.  This is particularly helpful, as sargeant is often run as a daemon with a severely limited environment.</p>
<h3 id="reloading-services">Reloading Services</h3>
<p>Services definitions are reloaded at a frequency specified by <code style="font-family: 'source code pro';">reloadTimeInSeconds</code>.  Allows new services to be added on the fly.  Existing services are updated, and obsolete services are removed.</p>
<h3 id="reaping-completed-status">Reaping Completed Status</h3>
<p>Services that are running or completed hold their status in memory.  By default, completed jobs (success or fail) are reaped every hour.  This may be controled by the <code style="font-family: 'source code pro';">reapTimeInSeconds</code> in the <code style="font-family: 'source code pro';">sergeant.yml</code> file.</p>
<h2 id="rest">REST</h2>
<p>Each service creates some REST APIs.  <code style="font-family: 'source code pro';">sleep</code> is the service used in this example.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>URL</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/rest/service</td>
<td>JSON description of all services</td>
</tr>
<tr>
<td>GET</td>
<td>/rest/job</td>
<td>JSON description of all jobs running and compteled that have not been reaped.</td>
</tr>
<tr>
<td>GET</td>
<td>/rest/service/sleep</td>
<td>Returns the definition of the service</td>
</tr>
<tr>
<td>POST</td>
<td>/rest/service/sleep</td>
<td>Starts executing the service.  If synchronous, blocks until the service completes.  If asynchronous, returns a <code style="font-family: 'source code pro';">uuid</code> that is used to lookup the status of the job.</td>
</tr>
<tr>
<td>GET</td>
<td>/rest/job/<code style="font-family: 'source code pro';">uuid</code></td>
<td>Returns job status.</td>
</tr>
<tr>
<td>DELETE</td>
<td>/rest/job/<code style="font-family: 'source code pro';">uuid</code></td>
<td>Deletes the job, killing if still running.</td>
</tr>
</tbody>
</table>
<h2 id="examples">Examples</h2>
<h3 id="sleep-example">Sleep Example</h3>
<p>Definition of the sleep service in <code style="font-family: 'source code pro';">sergeant.yml</code>.</p>
<pre class="editor-colors"><code class="lang-yml" style="font-family: 'source code pro';"><div><span class="source yaml"><span class="string unquoted yaml"><span class="entity name tag yaml">workers<span class="punctuation separator key-value yaml">:</span></span></span></span></div><div><span class="source yaml">  <span class="string unquoted yaml"><span class="punctuation definition entry yaml">- </span><span class="entity name tag yaml">endPoint<span class="punctuation separator key-value yaml">:</span></span> <span class="string unquoted yaml">sleep</span></span></span></div><div><span class="source yaml">    <span class="string unquoted yaml"><span class="entity name tag yaml">commandLine<span class="punctuation separator key-value yaml">:</span></span> [<span class="string quoted double yaml"><span class="punctuation definition string begin yaml">"</span>sleep<span class="punctuation definition string end yaml">"</span></span><span class="string unquoted yaml">, "@seconds"</span>]</span></span></div><div><span class="source yaml">    <span class="string unquoted yaml"><span class="entity name tag yaml">description<span class="punctuation separator key-value yaml">:</span></span> <span class="string quoted double yaml"><span class="punctuation definition string begin yaml">"</span>Powernap<span class="punctuation definition string end yaml">"</span></span></span></span></div><div><span class="source yaml">    <span class="string unquoted yaml"><span class="entity name tag yaml">defaults<span class="punctuation separator key-value yaml">:</span></span></span></span></div><div><span class="source yaml">      <span class="constant numeric yaml"><span class="entity name tag yaml">seconds<span class="punctuation separator key-value yaml">:</span></span> 120</span></span></div></code></pre>
<p>Invoking the sleep service.  NB: <code style="font-family: 'source code pro';">curl</code> converts a <code style="font-family: 'source code pro';">POST</code> command into a <code style="font-family: 'source code pro';">GET</code>, if no parameters are passed using the <code style="font-family: 'source code pro';">-d</code> flag.  The best workaround is to pass some dummy value.  Sergeant ignores any unknown substitutions.</p>
<pre class="editor-colors"><code class="lang-json" style="font-family: 'source code pro';"><div><span class="source json">curl -POST -d seconds=<span class="constant numeric json">120</span> http://localhost:<span class="constant numeric json">8080</span>/rest/service/sleep</span></div><div><span class="source json">  <span class="meta structure dictionary json"><span class="punctuation definition dictionary begin json">{</span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">    <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>uuid<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span><span class="string quoted double json"><span class="punctuation definition string begin json">"</span>519898b5-5afb-413d-bfc3-a2ff3a94afbd<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">    <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>commandLine<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span><span class="string quoted double json"><span class="punctuation definition string begin json">"</span>sleep 120<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">    <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>exitValue<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span><span class="constant numeric json">-1</span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">    <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>status<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span><span class="string quoted double json"><span class="punctuation definition string begin json">"</span>running<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">    <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>output<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span><span class="string quoted double json"><span class="punctuation definition string begin json">"</span><span class="punctuation definition string end json">"</span></span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="meta structure dictionary value json">  </span><span class="punctuation definition dictionary end json">}</span></span></span></div></code></pre>
<p>The response to the post includes the job <code style="font-family: 'source code pro';">uuid</code> used to look up status, the <code style="font-family: 'source code pro';">commandLine</code> called, <code style="font-family: 'source code pro';">exitValue</code> (-1 until the status is done), <code style="font-family: 'source code pro';">status</code> of the job, and <code style="font-family: 'source code pro';">output</code> of the job, when completed.</p>
<p>Status can be fetched using the <code style="font-family: 'source code pro';">uuid</code>:</p>
<pre class="editor-colors"><code class="lang-json" style="font-family: 'source code pro';"><div><span class="source json">curl http://localhost:<span class="constant numeric json">8080</span>/rest/job/<span class="constant numeric json">519898</span>b<span class="constant numeric json">5-5</span>afb<span class="constant numeric json">-413</span>d-bfc<span class="constant numeric json">3</span>-a<span class="constant numeric json">2</span>ff<span class="constant numeric json">3</span>a<span class="constant numeric json">94</span>afbd</span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="punctuation definition dictionary begin json">{</span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>uuid<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span><span class="string quoted double json"><span class="punctuation definition string begin json">"</span>519898b5-5afb-413d-bfc3-a2ff3a94afbd<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>commandLine<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span><span class="string quoted double json"><span class="punctuation definition string begin json">"</span>sleep 120<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>exitValue<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span><span class="constant numeric json">0</span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>status<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span><span class="string quoted double json"><span class="punctuation definition string begin json">"</span>done<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>output<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span><span class="string quoted double json"><span class="punctuation definition string begin json">"</span><span class="punctuation definition string end json">"</span></span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="punctuation definition dictionary end json">}</span></span></span></div></code></pre>
<p>Status from all jobs can be fetched:</p>
<pre class="editor-colors"><code class="lang-json" style="font-family: 'source code pro';"><div><span class="source json">curl http://localhost:<span class="constant numeric json">8080</span>/rest/job</span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="punctuation definition dictionary begin json">{</span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>519898b5-5afb-413d-bfc3-a2ff3a94afbd<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="meta structure dictionary json"><span class="punctuation definition dictionary begin json">{</span></span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="meta structure dictionary value json"><span class="meta structure dictionary json">    <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>uuid<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>519898b5-5afb-413d-bfc3-a2ff3a94afbd<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="meta structure dictionary value json"><span class="meta structure dictionary json">    <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>commandLine<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>sleep 120<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="meta structure dictionary value json"><span class="meta structure dictionary json">    <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>exitValue<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="constant numeric json">0</span><span class="punctuation separator dictionary pair json">,</span></span></span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="meta structure dictionary value json"><span class="meta structure dictionary json">    <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>status<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>done<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="meta structure dictionary value json"><span class="meta structure dictionary json">    <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>output<span class="punctuation definition string end json">"</span></span><span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span><span class="punctuation definition string end json">"</span></span></span></span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="meta structure dictionary value json"><span class="meta structure dictionary json"><span class="meta structure dictionary value json">  </span><span class="punctuation definition dictionary end json">}</span></span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="punctuation definition dictionary end json">}</span></span></span></div></code></pre>
<h2 id="positional-and-file-parameters">Positional and File Parameters</h2>
<p>In the definition of a service, there are several options for passing parameters, both file and positional arguments.</p>
<h3 id="positional-arguments">Positional Arguments</h3>
<p>Positional arguments are denoted by an <code style="font-family: 'source code pro';">@</code> symbol in the <code style="font-family: 'source code pro';">commandLine</code>.  A <code style="font-family: 'source code pro';">POST</code> call can substitute a value for the <code style="font-family: 'source code pro';">@</code> parameter.</p>
<h3 id="input-file-arguments">Input File Arguments</h3>
<p>Input file arguments are denoted by an <code style="font-family: 'source code pro';">&lt;</code> symbol in the <code style="font-family: 'source code pro';">commandLine</code>.</p>
<h3 id="output-file-arguments">Output File Arguments</h3>
<p>Input file arguments are denoted by an <code style="font-family: 'source code pro';">&gt;</code> symbol in the <code style="font-family: 'source code pro';">commandLine</code>.</p>
<h3 id="example">Example</h3>
<p>The following service expects 2 file arguments, <code style="font-family: 'source code pro';">&lt;input</code> is a file that will be uploaded via REST, and <code style="font-family: 'source code pro';">&gt;output</code> will be available for retrieval once the job is completed.</p>
<pre class="editor-colors"><code class="lang-yml" style="font-family: 'source code pro';"><div><span class="source yaml"><span class="string unquoted yaml"><span class="punctuation definition entry yaml">- </span><span class="entity name tag yaml">endPoint<span class="punctuation separator key-value yaml">:</span></span> <span class="string unquoted yaml">copy</span></span></span></div><div><span class="source yaml">  <span class="string unquoted yaml"><span class="entity name tag yaml">commandLine<span class="punctuation separator key-value yaml">:</span></span> [<span class="string quoted double yaml"><span class="punctuation definition string begin yaml">"</span>cp<span class="punctuation definition string end yaml">"</span></span><span class="string unquoted yaml">, "&lt;input", "&gt;output"</span>]</span></span></div><div><span class="source yaml">  <span class="string unquoted yaml"><span class="entity name tag yaml">synchronous<span class="punctuation separator key-value yaml">:</span></span> <span class="string unquoted yaml">false</span></span></span></div></code></pre>
<pre class="editor-colors"><code class="lang-bash" style="font-family: 'source code pro';"><div><span class="source shell">curl -v -POST --form output=temp --form input=@sergeant.yml http://localhost:8080/rest/service/copy</span></div></code></pre>
<p>Sergeant returns</p>
<pre class="editor-colors"><code class="lang-json" style="font-family: 'source code pro';"><div><span class="source json"><span class="meta structure dictionary json"><span class="punctuation definition dictionary begin json">{</span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>startTime<span class="punctuation definition string end json">"</span></span> <span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>Wed, 6 Aug 2014 15:44:33 -0500<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>startTimeInMillis<span class="punctuation definition string end json">"</span></span> <span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="constant numeric json">1407357873317</span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>uuid<span class="punctuation definition string end json">"</span></span> <span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>5f3c7466-03e5-41e9-a0bf-cd0680be449f<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>commandLine<span class="punctuation definition string end json">"</span></span> <span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>cp /tmp/5f3c7466-03e5-41e9-a0bf-cd0680be449f/input /tmp/5f3c7466-03e5-41e9-a0bf-cd0680be449f/temp<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>endPoint<span class="punctuation definition string end json">"</span></span> <span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>copy<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>fileMap<span class="punctuation definition string end json">"</span></span> <span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="meta structure dictionary json"><span class="punctuation definition dictionary begin json">{</span></span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="meta structure dictionary value json"><span class="meta structure dictionary json">    <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>input<span class="punctuation definition string end json">"</span></span> <span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>/tmp/5f3c7466-03e5-41e9-a0bf-cd0680be449f/input<span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="meta structure dictionary value json"><span class="meta structure dictionary json">    <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>output<span class="punctuation definition string end json">"</span></span> <span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>/tmp/5f3c7466-03e5-41e9-a0bf-cd0680be449f/temp<span class="punctuation definition string end json">"</span></span></span></span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="meta structure dictionary value json"><span class="meta structure dictionary json"><span class="meta structure dictionary value json">  </span><span class="punctuation definition dictionary end json">}</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>parsedCommandLine<span class="punctuation definition string end json">"</span></span> <span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="meta structure array json"><span class="punctuation definition array begin json">[</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>cp<span class="punctuation definition string end json">"</span></span><span class="punctuation separator array json">,</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>/tmp/5f3c7466-03e5-41e9-a0bf-cd0680be449f/input<span class="punctuation definition string end json">"</span></span><span class="punctuation separator array json">,</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>/tmp/5f3c7466-03e5-41e9-a0bf-cd0680be449f/temp<span class="punctuation definition string end json">"</span></span> <span class="punctuation definition array end json">]</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>exitValue<span class="punctuation definition string end json">"</span></span> <span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="constant numeric json">-1</span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>output<span class="punctuation definition string end json">"</span></span> <span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span><span class="punctuation definition string end json">"</span></span><span class="punctuation separator dictionary pair json">,</span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json">  <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>status<span class="punctuation definition string end json">"</span></span> <span class="meta structure dictionary value json"><span class="punctuation separator dictionary key-value json">:</span> <span class="string quoted double json"><span class="punctuation definition string begin json">"</span>running<span class="punctuation definition string end json">"</span></span></span></span></span></div><div><span class="source json"><span class="meta structure dictionary json"><span class="punctuation definition dictionary end json">}</span></span></span></div></code></pre>
<p>To retrieve the output file, use the <code style="font-family: 'source code pro';">uuid</code> and <code style="font-family: 'source code pro';">output</code> key.</p>
<pre class="editor-colors"><code class="lang-bash" style="font-family: 'source code pro';"><div><span class="source shell"> curl http://localhost:8080/rest/job/5f3c7466-03e5-41e9-a0bf-cd0680be449f/output</span></div><div><span class="source shell"> <span class="keyword operator redirect shell">&lt;</span>response truncated<span class="keyword operator redirect shell">&gt;</span></span></div></code></pre>
<h4 id="example-sergeant-yml">Example sergeant.yml</h4>
<p>DropWizard describes several other <a href="http://dropwizard.github.io/dropwizard/manual/core.html">configuration options</a>, including logging.</p>
<pre class="editor-colors"><code class="lang-yml" style="font-family: 'source code pro';"><div><span class="source yaml"><span class="comment line number-sign yaml"><span class="punctuation definition comment yaml">#</span> Reap completed job status every hour</span></span></div><div><span class="source yaml"><span class="constant numeric yaml"><span class="entity name tag yaml">reapTimeInSeconds<span class="punctuation separator key-value yaml">:</span></span> 3600</span></span></div><div>&nbsp;</div><div><span class="source yaml"><span class="comment line number-sign yaml"><span class="punctuation definition comment yaml">#</span> Reload this config file every minute to pick up service changes</span></span></div><div><span class="source yaml"><span class="constant numeric yaml"><span class="entity name tag yaml">reloadTimeInSeconds<span class="punctuation separator key-value yaml">:</span></span> 60</span></span></div><div>&nbsp;</div><div><span class="source yaml"><span class="comment line number-sign yaml"><span class="punctuation definition comment yaml">#</span> Services to expose</span></span></div><div><span class="source yaml"><span class="string unquoted yaml"><span class="entity name tag yaml">workers<span class="punctuation separator key-value yaml">:</span></span></span></span></div><div><span class="source yaml">  <span class="string unquoted yaml"><span class="punctuation definition entry yaml">- </span><span class="entity name tag yaml">endPoint<span class="punctuation separator key-value yaml">:</span></span> <span class="string unquoted yaml">sleep</span></span></span></div><div><span class="source yaml">    <span class="string unquoted yaml"><span class="entity name tag yaml">commandLine<span class="punctuation separator key-value yaml">:</span></span> [<span class="string quoted double yaml"><span class="punctuation definition string begin yaml">"</span>sleep<span class="punctuation definition string end yaml">"</span></span><span class="string unquoted yaml">, "@seconds"</span>]</span></span></div><div><span class="source yaml">    <span class="string unquoted yaml"><span class="entity name tag yaml">description<span class="punctuation separator key-value yaml">:</span></span> <span class="string quoted double yaml"><span class="punctuation definition string begin yaml">"</span>Power nap time!<span class="punctuation definition string end yaml">"</span></span></span></span></div><div><span class="source yaml">    <span class="string unquoted yaml"><span class="entity name tag yaml">defaults<span class="punctuation separator key-value yaml">:</span></span></span></span></div><div><span class="source yaml">      <span class="constant numeric yaml"><span class="entity name tag yaml">seconds<span class="punctuation separator key-value yaml">:</span></span> 120</span></span></div><div>&nbsp;</div><div><span class="source yaml">  <span class="string unquoted yaml"><span class="punctuation definition entry yaml">- </span><span class="entity name tag yaml">endPoint<span class="punctuation separator key-value yaml">:</span></span> <span class="string unquoted yaml">echo</span></span></span></div><div><span class="source yaml">    <span class="string unquoted yaml"><span class="entity name tag yaml">commandLine<span class="punctuation separator key-value yaml">:</span></span> [<span class="string quoted double yaml"><span class="punctuation definition string begin yaml">"</span>echo<span class="punctuation definition string end yaml">"</span></span><span class="string unquoted yaml">, "@text"</span>]</span></span></div><div><span class="source yaml">    <span class="string unquoted yaml"><span class="entity name tag yaml">description<span class="punctuation separator key-value yaml">:</span></span> <span class="string quoted double yaml"><span class="punctuation definition string begin yaml">"</span>Is there an echo in here?<span class="punctuation definition string end yaml">"</span></span></span></span></div><div><span class="source yaml">    <span class="string unquoted yaml"><span class="entity name tag yaml">synchronous<span class="punctuation separator key-value yaml">:</span></span> <span class="string unquoted yaml">true</span></span></span></div><div><span class="source yaml">    <span class="string unquoted yaml"><span class="entity name tag yaml">defaults<span class="punctuation separator key-value yaml">:</span></span></span></span></div><div><span class="source yaml">      <span class="string unquoted yaml"><span class="entity name tag yaml">text<span class="punctuation separator key-value yaml">:</span></span> <span class="string unquoted yaml">This space for rent</span></span></span></div></code></pre>